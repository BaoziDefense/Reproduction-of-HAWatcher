# HAWatcher

This is a reproduction of the paper:21USENIX-HAWatcher Semantics-Aware Anomaly Detection for Appified Smart Homes

# introduction

You should fully understand the content and structure of the article before implementing it.

I neglected to mention the initial rule extraction work in the HAWatcher step (which is in fact not part of HAWatcher, but part of the article `DSN20 - Cross App Interference Threats in Smart Homes Categorization, Detection and Handling`)
And i adopt the rule extraction method of the article`ndss24 CP-IoT: A Cross-Platform Monitoring System for Smart Home`, which is cross-platform and better than `HAWatcher`.

![image](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/assets/121147777/ef393ff2-cbd5-4bc2-92be-08304186ee42)


# docs

All possible implementation details can be found by referring to  [docs](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/tree/master/docs).

# papers

You might be interested in what's in it, but it's not required reading.

# datasets

### [hh125-rules-0623.txt](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/datasets/hh125-rules-0623.txt):

A smart home dataset I obtained, note that **this is not the author's dataset**.

![image](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/assets/121147777/9ece7de7-5b0a-418c-b35f-07513c754e49)



### [hh125_descriptions_of_attributes.txt](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/datasets/hh125_descriptions_of_attributes.txt):

It is used to generate the adjacency table. Refer to `docs` for details on how to collect them.

> All other documents can be generated by `codes`.Refer to the `docs` and you will know everything about them.

# codes

| codes                                                        | usage                                                        |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [MAIN.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/MAIN.py) | run the entire workflow                                      |
| [semantic_analysis.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/semantic_analysis.py) | first step of the whole work                                 |
| [known_rules.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/known_rules.py) | store the known smart_app rules                              |
| [calculate_similarity.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/calculate_similarity.py) | Calculating similarity between attributes and generating physical_and_userActivity_correlations |
| [device_information.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/device_information.py) | All devices in the dataset and their corresponding information |
| [eventLogs.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/eventLogs.py) | Mainly contains a hypothesis testing component and other auxiliary function |
| [correalation_refining.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/correalation_refining.py) | the title is as it sounds(Of course i spell it wrongly QAQ)  |
| [anomaly_detection.py](https://github.com/BaoziDefense/Reproduction-of-HAWatcher/blob/master/codes/anomaly_detection.py) | the title is as it sounds                                    |
| other codes                                                  | perhaps useless                                              |


| name                         | usage                                                    |
| ---------------------------- | -------------------------------------------------------- |
| get_rules_from_GUI.py        | the main workflow of getting rules from description page |
| causal_division.py           | Lemmatization and Partition                              |
| calculate_similarity_BERT.py | Capability Matching                                      |


